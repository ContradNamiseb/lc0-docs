<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<link href="../images/favicon.png" rel="icon" type="image/png"/>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Leela Chess Zero: neural/backends/metal/network_metal.cc File Reference</title>
<link href="../css/tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../js/jquery.js"></script>
<script type="text/javascript" src="../js/dynsections.js"></script>
<link href="../css/navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../js/resize.js"></script>
<script type="text/javascript" src="../js/navtreedata.js"></script>
<script type="text/javascript" src="../js/navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="../css/doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Leela Chess Zero<span id="projectnumber">&#160;dev</span>
   </div>
   <div id="projectbrief">Neural network based chess engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../js/menudata.js"></script>
<script type="text/javascript" src="../js/menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('pages/network__metal_8cc.html','../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">network_metal.cc File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="network__metal_8h_source.html">network_metal.h</a>&quot;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;cassert&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;functional&gt;</code><br />
<code>#include &lt;list&gt;</code><br />
<code>#include &lt;memory&gt;</code><br />
<code>#include &lt;mutex&gt;</code><br />
<code>#include &quot;<a class="el" href="MetalNetworkBuilder_8h_source.html">mps/MetalNetworkBuilder.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="neural_2factory_8h_source.html">neural/factory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="network__legacy_8h_source.html">neural/network_legacy.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="attention__policy__map_8h_source.html">neural/tables/attention_policy_map.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="policy__map_8h_source.html">neural/tables/policy_map.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="bititer_8h_source.html">utils/bititer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="exception_8h_source.html">utils/exception.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../images/closed.png" alt="+"/> Include dependency graph for network_metal.cc:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../images/network__metal_8cc__incl.png" border="0" usemap="#aneural_2backends_2metal_2network__metal_8cc" alt=""/></div>
<map name="aneural_2backends_2metal_2network__metal_8cc" id="aneural_2backends_2metal_2network__metal_8cc">
<area shape="rect" title=" " alt="" coords="1110,5,1281,45"/>
<area shape="rect" href="network__metal_8h.html" title=" " alt="" coords="188,101,320,126"/>
<area shape="poly" title=" " alt="" coords="1110,32,773,51,558,70,341,96,315,100,314,95,340,91,557,64,772,46,1110,27"/>
<area shape="rect" title=" " alt="" coords="69,181,111,207"/>
<area shape="poly" title=" " alt="" coords="1110,31,878,38,587,50,324,69,230,82,176,96,154,111,134,130,105,171,101,167,130,127,150,107,174,91,229,76,324,64,587,45,878,32,1110,26"/>
<area shape="rect" href="neural_2factory_8h.html" title=" " alt="" coords="671,181,794,207"/>
<area shape="poly" title=" " alt="" coords="1144,48,778,179,777,174,1142,43"/>
<area shape="rect" title=" " alt="" coords="261,328,348,353"/>
<area shape="poly" title=" " alt="" coords="1111,47,904,96,821,115,748,128,624,148,566,161,507,182,443,212,372,257,341,286,320,317,315,314,337,282,368,253,440,208,505,177,564,156,623,142,747,123,820,110,903,91,1109,42"/>
<area shape="rect" title=" " alt="" coords="957,401,1034,427"/>
<area shape="poly" title=" " alt="" coords="1281,30,1350,37,1422,49,1483,67,1506,78,1521,92,1527,102,1528,112,1522,134,1495,209,1465,264,1446,288,1422,311,1358,356,1333,367,1300,377,1216,393,1048,412,1048,406,1216,387,1299,372,1331,362,1355,351,1419,306,1442,285,1460,261,1490,206,1517,132,1523,112,1522,104,1517,95,1503,83,1481,72,1421,55,1350,43,1281,35"/>
<area shape="rect" href="exception_8h.html" title=" " alt="" coords="794,401,925,427"/>
<area shape="poly" title=" " alt="" coords="1176,47,1157,68,1143,94,1139,113,1143,132,1153,153,1166,171,1199,201,1237,227,1275,250,1308,271,1329,295,1334,308,1333,322,1327,338,1315,355,1286,375,1244,388,1194,396,1139,399,1029,401,945,404,939,405,938,399,944,399,1029,395,1139,394,1194,390,1243,383,1283,370,1311,351,1322,335,1328,321,1328,309,1324,297,1304,275,1272,254,1235,232,1196,206,1162,174,1148,155,1138,134,1133,113,1138,92,1153,65,1172,44"/>
<area shape="rect" href="network__legacy_8h.html" title=" " alt="" coords="5,328,185,353"/>
<area shape="poly" title=" " alt="" coords="1110,31,868,36,560,48,282,67,182,80,126,96,100,112,82,130,70,152,59,182,54,218,59,254,71,287,84,315,79,317,66,289,54,255,49,218,54,181,65,150,78,127,96,108,124,91,181,75,281,62,560,42,867,31,1110,25"/>
<area shape="rect" title=" " alt="" coords="1153,101,1238,126"/>
<area shape="poly" title=" " alt="" coords="1198,46,1198,87,1193,87,1193,46"/>
<area shape="rect" title=" " alt="" coords="1262,101,1331,126"/>
<area shape="poly" title=" " alt="" coords="1220,44,1274,89,1270,93,1216,48"/>
<area shape="rect" title=" " alt="" coords="1356,101,1419,126"/>
<area shape="poly" title=" " alt="" coords="1239,43,1350,93,1348,98,1236,48"/>
<area shape="rect" title=" " alt="" coords="1443,101,1507,126"/>
<area shape="poly" title=" " alt="" coords="1272,43,1350,64,1432,91,1438,93,1436,98,1430,96,1348,70,1270,48"/>
<area shape="rect" href="MetalNetworkBuilder_8h.html" title=" " alt="" coords="1098,328,1301,353"/>
<area shape="poly" title=" " alt="" coords="1151,48,1122,67,1099,95,1095,113,1099,133,1116,186,1140,237,1186,315,1181,318,1135,239,1111,188,1094,134,1089,113,1094,92,1118,63,1148,43"/>
<area shape="rect" href="attention__policy__map_8h.html" title=" " alt="" coords="1582,93,1753,133"/>
<area shape="poly" title=" " alt="" coords="1281,39,1569,91,1568,97,1280,45"/>
<area shape="rect" href="policy__map_8h.html" title=" " alt="" coords="1777,93,1928,133"/>
<area shape="poly" title=" " alt="" coords="1281,32,1496,54,1764,91,1763,96,1496,59,1281,37"/>
<area shape="rect" href="bititer_8h.html" title=" " alt="" coords="1953,101,2057,126"/>
<area shape="poly" title=" " alt="" coords="1281,26,1410,32,1575,44,1758,63,1941,91,1957,94,1956,100,1940,96,1757,68,1574,49,1410,37,1281,32"/>
<area shape="poly" title=" " alt="" coords="231,128,125,179,123,174,229,124"/>
<area shape="rect" href="metal__common_8h.html" title=" " alt="" coords="186,181,322,207"/>
<area shape="poly" title=" " alt="" coords="257,126,257,167,251,167,251,126"/>
<area shape="poly" title=" " alt="" coords="320,123,658,178,657,183,320,128"/>
<area shape="poly" title=" " alt="" coords="238,128,207,152,176,183,153,217,133,253,106,316,101,314,129,251,148,214,172,180,204,148,235,124"/>
<area shape="rect" title=" " alt="" coords="611,401,673,427"/>
<area shape="poly" title=" " alt="" coords="251,208,241,237,233,275,234,316,240,335,251,351,274,368,309,380,352,387,399,391,494,394,568,399,597,403,597,408,567,404,494,400,399,396,351,392,308,385,272,373,247,355,235,337,229,317,228,275,236,235,246,206"/>
<area shape="poly" title=" " alt="" coords="671,201,552,218,484,234,419,257,368,287,328,321,324,317,365,283,417,252,483,229,551,212,671,196"/>
<area shape="rect" title=" " alt="" coords="481,401,555,427"/>
<area shape="poly" title=" " alt="" coords="671,203,612,210,550,221,496,236,477,246,464,256,455,272,453,289,454,307,460,325,479,360,500,389,496,392,474,363,455,327,449,308,447,289,450,270,460,253,474,241,494,231,549,215,611,204,671,197"/>
<area shape="rect" title=" " alt="" coords="1290,401,1349,427"/>
<area shape="poly" title=" " alt="" coords="794,194,958,202,1059,210,1165,222,1267,239,1359,261,1433,290,1461,307,1481,326,1490,343,1487,358,1476,371,1458,382,1411,398,1363,409,1362,404,1410,393,1455,377,1472,367,1482,356,1485,344,1477,330,1457,311,1430,295,1357,267,1266,244,1164,227,1059,215,957,207,794,199"/>
<area shape="rect" href="loader_8h.html" title=" " alt="" coords="475,255,593,280"/>
<area shape="poly" title=" " alt="" coords="702,209,580,252,579,247,700,204"/>
<area shape="rect" href="network_8h.html" title=" " alt="" coords="576,328,708,353"/>
<area shape="poly" title=" " alt="" coords="744,206,763,240,767,261,762,281,736,308,704,325,702,321,733,304,757,279,762,261,758,242,740,208"/>
<area shape="rect" href="wrapper_8h.html" title=" " alt="" coords="617,255,747,280"/>
<area shape="poly" title=" " alt="" coords="726,209,700,245,696,242,722,205"/>
<area shape="rect" href="optionsdict_8h.html" title=" " alt="" coords="783,328,922,353"/>
<area shape="poly" title=" " alt="" coords="745,205,836,316,832,319,740,209"/>
<area shape="rect" href="optionsparser_8h.html" title=" " alt="" coords="873,255,1027,280"/>
<area shape="poly" title=" " alt="" coords="768,204,903,248,901,253,767,209"/>
<area shape="poly" title=" " alt="" coords="538,279,547,314,566,352,587,374,611,392,607,396,583,378,561,355,542,315,533,281"/>
<area shape="poly" title=" " alt="" coords="533,281,522,328,520,388,514,387,517,328,528,280"/>
<area shape="poly" title=" " alt="" coords="594,276,605,277,770,300,934,325,1126,365,1277,400,1276,405,1125,370,934,331,769,305,604,283,593,281"/>
<area shape="poly" title=" " alt="" coords="553,278,614,318,611,323,550,282"/>
<area shape="rect" title=" " alt="" coords="195,401,308,427"/>
<area shape="poly" title=" " alt="" coords="513,283,287,398,284,393,510,278"/>
<area shape="poly" title=" " alt="" coords="645,354,645,388,639,388,639,354"/>
<area shape="poly" title=" " alt="" coords="699,351,944,400,942,405,698,356"/>
<area shape="poly" title=" " alt="" coords="580,356,322,403,321,397,579,351"/>
<area shape="poly" title=" " alt="" coords="678,351,812,394,810,400,676,356"/>
<area shape="poly" title=" " alt="" coords="622,283,362,331,361,326,621,277"/>
<area shape="poly" title=" " alt="" coords="748,271,1087,299,1243,314,1314,326,1324,340,1328,356,1328,387,1322,387,1323,357,1319,342,1311,330,1242,320,1086,304,747,276"/>
<area shape="poly" title=" " alt="" coords="678,282,658,317,653,315,673,279"/>
<area shape="poly" title=" " alt="" coords="820,356,687,400,685,395,818,351"/>
<area shape="poly" title=" " alt="" coords="799,356,569,405,568,399,798,351"/>
<area shape="poly" title=" " alt="" coords="922,350,1276,403,1276,409,922,355"/>
<area shape="poly" title=" " alt="" coords="877,351,961,393,959,397,874,356"/>
<area shape="poly" title=" " alt="" coords="856,353,860,388,854,388,851,354"/>
<area shape="rect" title=" " alt="" coords="332,401,456,427"/>
<area shape="poly" title=" " alt="" coords="783,355,470,404,469,398,783,350"/>
<area shape="poly" title=" " alt="" coords="906,283,842,302,772,330,716,363,669,395,666,391,713,358,770,326,840,297,904,278"/>
<area shape="poly" title=" " alt="" coords="1028,269,1148,277,1283,288,1398,304,1438,314,1460,326,1468,341,1467,355,1458,367,1443,377,1405,394,1363,406,1361,401,1403,389,1441,373,1454,363,1462,353,1463,342,1456,330,1436,319,1397,310,1283,293,1148,282,1028,275"/>
<area shape="poly" title=" " alt="" coords="959,279,981,327,994,387,989,388,975,329,954,281"/>
<area shape="poly" title=" " alt="" coords="953,281,950,315,945,336,936,355,917,378,894,396,891,392,913,374,932,352,940,334,945,314,948,280"/>
<area shape="poly" title=" " alt="" coords="936,282,881,322,878,317,933,278"/>
<area shape="poly" title=" " alt="" coords="186,350,568,399,597,403,597,408,567,404,185,355"/>
<area shape="poly" title=" " alt="" coords="121,351,214,393,212,398,119,356"/>
<area shape="poly" title=" " alt="" coords="144,351,333,395,332,401,143,356"/>
<area shape="poly" title=" " alt="" coords="1110,356,687,410,687,404,1109,351"/>
<area shape="poly" title=" " alt="" coords="1220,351,1289,392,1286,396,1217,356"/>
</map>
</div>
</div>
<p><a href="network__metal_8cc_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacelczero" id="r_namespacelczero"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelczero.html">lczero</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacelczero_1_1metal__backend" id="r_namespacelczero_1_1metal__backend"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelczero_1_1metal__backend.html">lczero::metal_backend</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac5301e6ede50384be4dbdca488f5ce4b" id="r_ac5301e6ede50384be4dbdca488f5ce4b"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelczero_1_1metal__backend.html#ac5301e6ede50384be4dbdca488f5ce4b">lczero::metal_backend::activationString</a> (pblczero::NetworkFormat::ActivationFunction act)</td></tr>
<tr class="separator:ac5301e6ede50384be4dbdca488f5ce4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ccb23531348cbeb333204f826ebbf42" id="r_a5ccb23531348cbeb333204f826ebbf42"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlczero_1_1Network.html">Network</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelczero_1_1metal__backend.html#a5ccb23531348cbeb333204f826ebbf42">lczero::metal_backend::MakeMetalNetwork</a> (const std::optional&lt; <a class="el" href="namespacelczero.html#a6705e82c4f5d6edcac8d0ca3b2240b29">WeightsFile</a> &gt; &amp;w, const <a class="el" href="classlczero_1_1OptionsDict.html">OptionsDict</a> &amp;options)</td></tr>
<tr class="separator:a5ccb23531348cbeb333204f826ebbf42"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_8e636a8183a052b37e67a9d6ecfc1284.html">neural</a></li><li class="navelem"><a class="el" href="dir_bcb87c58648cf6d42eb5696d4b5948e4.html">backends</a></li><li class="navelem"><a class="el" href="dir_a5aa2392c0c05ca0b3460045ee9091e3.html">metal</a></li><li class="navelem"><a class="el" href="network__metal_8cc.html">network_metal.cc</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../images/doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
